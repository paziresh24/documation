{
  "openapi": "3.0.1",
  "info": {
    "title": "Reviews APIs",
    "version": "v1.0.0",
    "description": "APIs related to managing reviews and doctor replies to comments."
  },
  "servers": [
    {
      "url": "https://apigw.paziresh24.com"
    }
  ],
  "security": [
    {
      "BearerAuth": []
    }
  ],
  "tags": [
    { "name": "Reviews" },
    { "name": "Replies" }
  ],
  "paths": {
    "/open-platform/v1/reviews": {
      "get": {
        "summary": "Get reviews list",
        "description": "Retrieves a list of reviews with pagination and sorting options.",
        "operationId": "getReviews",
        "tags": ["Reviews"],
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "description": "Number of items to return per page. Default is 10.",
            "schema": {
              "type": "integer",
              "default": 10
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "description": "Number of items to skip. Default is 0.",
            "schema": {
              "type": "integer",
              "default": 0
            }
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "description": "Sort order. Options: -created_at, -default_order, -count_like. Default is -created_at.",
            "schema": {
              "type": "string",
              "enum": ["-created_at", "-default_order", "-count_like"],
              "default": "-created_at"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved reviews list.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReviewsListResponse"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions."
          },
          "default": {
            "description": "Unexpected error occurred.",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/open-platform/v1/reviews/{id}/reply": {
      "post": {
        "summary": "Create doctor reply to review",
        "description": "Allows a doctor to reply to a patient's review comment.",
        "operationId": "createReviewReply",
        "tags": ["Replies"],
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique identifier of the review.",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateReplyBody"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Reply successfully created.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateReplyResponse"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Insufficient permissions."
          },
          "404": {
            "description": "Review not found."
          },
          "default": {
            "description": "Unexpected error occurred.",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ReviewItem": {
        "type": "object",
        "properties": {
          "Id": {
            "type": "integer",
            "description": "Unique identifier of the review",
            "example": 5430410
          },
          "avg_rate_value": {
            "type": "integer",
            "description": "Average rating value",
            "example": 4
          },
          "treatment_status": {
            "type": "string",
            "nullable": true,
            "description": "Treatment status",
            "example": null
          },
          "quality_of_treatment": {
            "type": "integer",
            "description": "Quality of treatment rating",
            "example": 4
          },
          "count_like": {
            "type": "integer",
            "nullable": true,
            "description": "Number of likes",
            "example": null
          },
          "show": {
            "type": "integer",
            "description": "Visibility status (1 = visible, 0 = hidden)",
            "example": 1
          },
          "doctor_encounter": {
            "type": "integer",
            "description": "Doctor encounter rating",
            "example": 4
          },
          "visit_date": {
            "type": "string",
            "nullable": true,
            "description": "Visit date",
            "example": null
          },
          "reply_to_feedback_id": {
            "type": "integer",
            "nullable": true,
            "description": "ID of the review this is a reply to",
            "example": null
          },
          "recommend_range": {
            "type": "integer",
            "description": "Recommendation rating",
            "example": 5
          },
          "explanation_of_issue": {
            "type": "integer",
            "description": "Explanation of issue rating",
            "example": 4
          },
          "center_name": {
            "type": "string",
            "description": "Name of the medical center",
            "example": "ویزیت آنلاین پذیرش24"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp",
            "example": "2025-12-03 13:05:53+00:00"
          },
          "visit_status": {
            "type": "string",
            "description": "Visit status",
            "example": "visited"
          },
          "visit_reason": {
            "type": "string",
            "nullable": true,
            "description": "Reason for visit",
            "example": null
          },
          "user_id": {
            "type": "integer",
            "description": "User ID who wrote the review",
            "example": 3313319
          },
          "waiting_time": {
            "type": "integer",
            "description": "Waiting time in minutes",
            "example": 0
          },
          "center_id": {
            "type": "string",
            "description": "Medical center ID",
            "example": "5532"
          },
          "clinic_feedback_id": {
            "type": "integer",
            "nullable": true,
            "description": "Clinic feedback ID",
            "example": null
          },
          "doctor_slug": {
            "type": "string",
            "description": "Doctor slug (URL-friendly identifier)",
            "example": "دکتر-امیرحسین-بیگی"
          },
          "description": {
            "type": "string",
            "description": "Review description/comment",
            "example": "پزشک کارمو راه انداخت، مرسی از پذیرش۲۴"
          },
          "user_display_name": {
            "type": "string",
            "nullable": true,
            "description": "User display name",
            "example": null
          },
          "recommended": {
            "type": "boolean",
            "nullable": true,
            "description": "Whether the doctor is recommended",
            "example": null
          }
        }
      },
      "PageInfo": {
        "type": "object",
        "properties": {
          "totalRows": {
            "type": "integer",
            "description": "Total number of rows",
            "example": 1
          },
          "page": {
            "type": "integer",
            "description": "Current page number",
            "example": 1
          },
          "pageSize": {
            "type": "integer",
            "description": "Number of items per page",
            "example": 10
          },
          "isFirstPage": {
            "type": "boolean",
            "description": "Whether this is the first page",
            "example": true
          },
          "isLastPage": {
            "type": "boolean",
            "description": "Whether this is the last page",
            "example": true
          }
        }
      },
      "ReviewsListResponse": {
        "type": "object",
        "properties": {
          "list": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ReviewItem"
            }
          },
          "pageInfo": {
            "$ref": "#/components/schemas/PageInfo"
          }
        }
      },
      "CreateReplyBody": {
        "type": "object",
        "required": ["description"],
        "properties": {
          "description": {
            "type": "string",
            "description": "Reply text/description",
            "example": "تست"
          }
        }
      },
      "CreateReplyResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message",
            "example": "پاسخ شما با موفقیت ثبت شد"
          }
        }
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "The token must be sent in the `Authorization` header."
      }
    }
  },
  "x-original-swagger-version": "2.0"
}


